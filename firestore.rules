// Firestore security rules for Ahmed ⇄ Xeo chat app
//
// This policy restricts all database access to just two user UIDs.
// Before publishing these rules, replace UID_OF_AHMED and UID_OF_XEO
// with the actual UIDs of the two accounts you created in Firebase
// Authentication.  You can find these in the Firebase Console under
// Authentication → Users.

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Helper function: returns true only if the request comes from an
    // authenticated user whose UID is in our allowed list.
    function isAllowed() {
      return request.auth != null && (
        request.auth.uid in [
          "JP6UGphb5nTXTPhfczyzAi6zf542", // ← replace with Ahmed’s real UID
          "M76IECUlLJRcqz7GQsrfAnkaGUJ3"    // ← replace with Xeo’s real UID
        ]
      );
    }

    // Allow these two users to read and write any document under
    // the rooms collection.  If you want to restrict to a single
    // room ID, change the wildcard {roomId} to the specific room name.
    match /rooms/{roomId} {
      allow read, write: if isAllowed();

      // Nested match for messages within a room.  This could be
      // omitted, as it inherits the allow statement above, but is
      // included for clarity.
      match /messages/{msgId} {
        allow read, create, update, delete: if isAllowed();
      }
    }
  }
}
